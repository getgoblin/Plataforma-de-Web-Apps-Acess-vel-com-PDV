<!-- CAMADA 3: botão fixo no mesmo ponto do topo -->
<div #topbtn class="wo__topbtn">
  <app-widgets-button></app-widgets-button>
</div>

<!-- CAMADA 1: FX (ripple) -->
<div #fx class="wo__fx" aria-hidden="true">
  <!-- Onda verde (abre primeiro / fecha por último) -->
  <div class="wo__wave wo__wave--green"
       (animationend)="onGreenAnimEnd()"></div>

  <!-- Onda escura (abre depois / fecha primeiro) -->
  <div class="wo__wave wo__wave--dark"
       (animationend)="onDarkAnimEnd()"></div>
</div>

<!-- CAMADA 2: Catálogo (só em ready / fading) -->
<div *ngIf="state() === 'ready' || state() === 'fading'"
     class="wo__dialog"
     role="dialog" aria-modal="true"
     [class.is-fading]="state() === 'fading'"
     (animationend)="onDialogFadeEnd($event)">

  <header class="wo__header">
    <h2 id="widgets-title">Widget-apps</h2>
    <button type="button" class="wo__close btn-circle" aria-label="Fechar" (click)="close()">✕</button>
  </header>

  <section class="wo__content" aria-label="Catálogo de aplicativos">
    <div class="wo__empty" *ngIf="categories().length === 0">
      <p>Sem apps disponíveis.</p>
      <small>Adicione apps para vê-los aqui.</small>
    </div>

    <div class="wo__section" *ngFor="let cat of categories()">
      <h3 class="wo__cat">{{ cat[0] }}</h3>
      <ul class="wo__grid" role="list">
        <li *ngFor="let app of cat[1]">
          <button type="button" class="wo__card" (click)="openApp(app)">
            <span class="wo__icon btn-circle" style="--size:56px">{{ app.icon }}</span>
            <strong class="wo__title">{{ app.name }}</strong>
          </button>
        </li>
      </ul>
    </div>
  </section>
</div>
